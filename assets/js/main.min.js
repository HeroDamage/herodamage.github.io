(function(e){function t(e){return new Intl.NumberFormat("en-US").format(e)}e.hasInitialized||(e.copyToClipboard=function(e){var t=document.getElementById(e);t.select(),document.execCommand("Copy")},function(){var o,n=!1;e.combinationsUpdate=function(){if(o){var e=document.getElementById("combinations-table-filter-talents").value,r=new RegExp("^"+e.replace(new RegExp("x|\\*","ig"),"[0-3]"),"i"),a=$("#combinations-table-filter-sets").val(),i=$("#combinations-table-filter-legendaries").val(),l=$.grep(o,function(t){if(""!==e&&!r.test(t[0]))return!1;if(a.indexOf(t[1])<0)return!1;var o=t[2].split(", ");return!($(i).filter(o).length<o.length&&"None"!==t[2])}),s=document.getElementById("combinations-table-data"),c=$(document.getElementById("combinations-table-nav"));c.data("twbs-pagination")&&c.twbsPagination("destroy"),c.twbsPagination({totalPages:Math.max(1,Math.ceil(l.length/15)),visiblePages:3,onPageClick:function(e,o){var r="";l.slice(15*(o-1),15*o).forEach(function(e){r+="<tr>",r+="<td>"+e[e.length-1]+"</td>",r+="<td>"+e[0]+"</td>",r+="<td>"+e[1]+"</td>",r+="<td>"+e[2]+"</td>",r+="<td>"+t(e[3])+"</td>",n&&(r+="<td>",6===e.length&&(r+=t(e[4])),r+="</td>"),r+="</tr>"}),s.innerHTML=r}})}},e.combinationsInit=function(t){$.get("/"+t,function(t){o=$.csv.toArrays(t),o.sort(function(e,t){return t[3]-e[3]});var r=0,a=[],i=[];o.forEach(function(e){r++,e.push(r),$.inArray(e[1],a)<0&&a.push(e[1]),e[2].split(", ").forEach(function(e){"None"!==e&&$.inArray(e,i)<0&&i.push(e)}),n||6!==e.length||(n=!0)}),a.sort().reverse(),a.forEach(function(e){document.getElementById("combinations-table-filter-sets").insertAdjacentHTML("beforeend","<option>"+e+"</option>")});var l=$("#combinations-table-filter-sets");l.selectpicker("val",a),l.selectpicker("refresh"),i.sort(),i.forEach(function(e){document.getElementById("combinations-table-filter-legendaries").insertAdjacentHTML("beforeend","<option>"+e+"</option>")});var s=$("#combinations-table-filter-legendaries"),c=i.indexOf("Cinidaria");c>-1&&i.splice(c,1),s.selectpicker("val",i),s.selectpicker("refresh"),n&&(document.getElementById("combinations-table-headers").insertAdjacentHTML("beforeend","<th>Boss DPS</th>"),document.getElementById("combinations-table-filters").insertAdjacentHTML("beforeend","<th></th>")),e.combinationsUpdate(),$(document.getElementById("combinations-loading")).remove()})}}(),e.relicsInit=function(e,o,n){function r(e){var t=new google.visualization.DataView(e),o=t.getFilteredRows([{column:1,value:null}]);return t.hideRows(o),t.toDataTable()}function a(){for(var t=["string"],o=0;o<n;o++)t.push("number"),t.push("string");var r=new google.visualization.Query("/"+e,{csvColumns:t,csvHasHeader:!1});r.send(i)}function i(e){if(e.isError())return void alert("Error in query: "+e.getMessage()+" "+e.getDetailedMessage());var n,a,i=e.getDataTable();for(i.sort([{column:i.getNumberOfColumns()-1,desc:!0},{column:5,desc:!0}]),n=2;n<i.getNumberOfColumns();n+=2)i.setColumnProperties(n,{type:"string",role:"annotation"});for(n=3;n<=i.getNumberOfColumns();n+=4)i.insertColumn(n,{type:"string",role:"tooltip",p:{html:!0}}),i.insertColumn(n+1,{type:"string",role:"style"});var l=["LightSpeed","InfusionOfLight","SecureInTheLight","Shocklight"],s=["MasterOfShadows","MurderousIntent","Shadowbind","TormentTheWeak","ChaoticDarkness","DarkSorrows"];for(a=0;a<i.getNumberOfRows();a++){var c="";$.inArray(i.getValue(a,0),l)>=0?c="stroke-width: 4; stroke-color: #bb8800; color: #ffcc00":$.inArray(i.getValue(a,0),s)>=0&&(c="stroke-width: 4; stroke-color: #5500aa; color: #8800ff");var u=0;for(n=1;n<i.getNumberOfColumns();n+=4){var d=i.getValue(a,n),g=d-u,m='<div class="chart-tooltip"><b>'+i.getValue(a,n+1)+"x "+i.getValue(a,0)+"</b><br><b>Total:</b> "+t(d.toFixed())+"<br><b>Increase:</b> "+t(g.toFixed())+"</div>";i.setValue(a,n+2,m),i.setValue(a,n+3,c),i.setValue(a,n,g),g<0&&(i.setValue(a,n,0),i.setValue(a,n+1,"")),u=d>u?d:u}}var f=i.addColumn("number");for(a=0;a<i.getNumberOfRows();a++)$.inArray(i.getValue(a,0),l)>=0||$.inArray(i.getValue(a,0),s)>=0?i.setValue(a,f,1):i.setValue(a,f,0);i.sort([{column:f,desc:!1}]),i.removeColumn(f);var b=document.getElementById("fightstyle-tabs"),h=b.innerWidth-2*window.getComputedStyle(b,null).getPropertyValue("padding-left"),v=document.documentElement.clientWidth>=768?h:700,p="#222",y="#CCC",w={title:o,backgroundColor:p,chartArea:{top:50,bottom:100,left:150,right:50},hAxis:{gridlines:{count:20},format:"short",textStyle:{color:y},title:"DPS Increase",titleTextStyle:{color:y},viewWindow:{min:0}},vAxis:{textStyle:{fontSize:12,color:y},titleTextStyle:{color:y}},annotations:{textStyle:{fontSize:10},alwaysOutside:!0,stem:{length:-10,color:"transparent"}},titleTextStyle:{color:y},tooltip:{isHtml:!0},legend:{position:"none"},isStacked:!0,width:v},C=new google.visualization.BarChart(document.getElementById("google-chart"));C.draw(r(i),w)}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(a)},e.trinketsInit=function(e,o){function n(e){var t=new google.visualization.DataView(e),o=t.getFilteredRows([{column:1,value:null}]);return t.hideRows(o),t.toDataTable()}function r(){$.get("/"+e,function(e){var r,a,i=$.csv.toArrays(e,{onParseValue:function(e,t){return t.rowNum<=1?e.toString():$.csv.hooks.castToScalar(e,t)}}),l=new google.visualization.arrayToDataTable(i),s=l.addColumn("number");for(a=0;a<l.getNumberOfRows();a++){var c=0;for(r=1;r<s;r++)l.getValue(a,r)>c&&(c=l.getValue(a,r));l.setValue(a,s,c)}for(l.sort([{column:s,desc:!0}]),l.removeColumn(s),r=2;r<=l.getNumberOfColumns();r+=2)l.insertColumn(r,{type:"string",role:"tooltip",p:{html:!0}});for(a=0;a<l.getNumberOfRows();a++){var u=0;for(r=1;r<l.getNumberOfColumns();r+=2){var d=l.getValue(a,r),g=d-u,m='<div class="chart-tooltip"><b>'+l.getValue(a,0)+"<br> Item Level "+l.getColumnLabel(r)+"</b><br><b>Total:</b> "+t(d.toFixed())+"<br><b>Increase:</b> "+t(g.toFixed())+"</div>";l.setValue(a,r+1,m),l.setValue(a,r,g),u=d>u?d:u}}var f=document.getElementById("fightstyle-tabs"),b=f.innerWidth-2*window.getComputedStyle(f,null).getPropertyValue("padding-left"),h=document.documentElement.clientWidth>=768?b:700,v="#222",p="#CCC",y={title:o,backgroundColor:v,chartArea:{top:50,bottom:100,right:150,left:200},hAxis:{gridlines:{count:20},format:"short",textStyle:{color:p},title:"DPS Increase",titleTextStyle:{color:p},viewWindow:{min:0}},vAxis:{textStyle:{fontSize:12,color:p},titleTextStyle:{color:p}},legend:{textStyle:{color:p}},titleTextStyle:{color:p},tooltip:{isHtml:!0},isStacked:!0,width:h},w=new google.visualization.BarChart(document.getElementById("google-chart"));w.draw(n(l),y)})}google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(r)},e.hasInitialized=!0,window.herodamage=e)})(window.herodamage||{});