!function(e){var t,o,n,r,i;e.hasInitialized||(e.copyToClipboard=function(e){document.getElementById(e).select(),document.execCommand("Copy")},r=0,i=!1,e.combinationsUpdate=function(){if(t){var e=document.getElementById("combinations-table-filter-talents").value,l=new RegExp("^"+e.replace(new RegExp("x|\\*","ig"),"[0-3]"),"i"),s=o.val(),c=n.val(),d=$.grep(t,function(t){if(""!==e&&!l.test(t[1]))return!1;if(s.indexOf(t[2])<0)return!1;var o=t[3].split(", ");return!($(c).filter(o).length<o.length&&"None"!==t[3])}),u=document.getElementById("combinations-table-data"),g=$(document.getElementById("combinations-table-nav"));g.data("twbs-pagination")&&g.twbsPagination("destroy"),g.twbsPagination({totalPages:Math.max(1,Math.ceil(d.length/15)),visiblePages:3,onPageClick:function(e,t){var o="";d.slice(15*(t-1),15*t).forEach(function(e){o+="<tr>",o+="<td>"+e[0]+"</td>",o+="<td>"+e[1]+"</td>",o+="<td>"+e[2]+"</td>",o+="<td>"+e[3]+"</td>",o+="<td>"+a(e[4])+"</td>",i&&(o+="<td>",6===e.length&&(o+=a(e[5])),o+="</td>"),e[4]==r?o+="<td></td>":o+="<td>"+(100*e[4]/r-100).toFixed(1)+"%</td>",o+="</tr>"}),u.innerHTML=o}})}},e.combinationsInit=function(a){$.get("/"+a,function(a){var s,c=[],d=[];(t=a).forEach(function(e){$.inArray(e[2],c)<0&&c.push(e[2]),e[3].split(", ").forEach(function(e){"None"!==e&&$.inArray(e,d)<0&&d.push(e)}),e[4]>r&&(r=e[4]),i||6!==e.length||(i=!0)}),c.sort().reverse(),c.forEach(function(e){document.getElementById("combinations-table-filter-sets").insertAdjacentHTML("beforeend","<option>"+e+"</option>")}),(o=$("#combinations-table-filter-sets")).selectpicker("val",c),o.selectpicker("refresh"),d.sort(),d.forEach(function(e){document.getElementById("combinations-table-filter-legendaries").insertAdjacentHTML("beforeend","<option>"+e+"</option>")}),n=$("#combinations-table-filter-legendaries"),(s=d.indexOf("Cinidaria"))>-1&&d.splice(s,1),n.selectpicker("val",d),n.selectpicker("refresh");var u=document.getElementById("combinations-table-headers"),g=document.getElementById("combinations-table-filters");i&&(u.insertAdjacentHTML("beforeend","<th>Boss DPS</th>"),g.insertAdjacentHTML("beforeend","<th></th>")),u.insertAdjacentHTML("beforeend","<th></th>"),g.insertAdjacentHTML("beforeend","<th></th>"),e.combinationsUpdate(),l()})},e.relicsInit=function(e,t,o){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){$.get("/"+e,function(e){var n,r;(e=new google.visualization.arrayToDataTable(e)).sort({column:5,desc:!0});var i=["Weapon Item Level","% DPS Gain"];for(e=function(e,t){var o,n,r;for(o=0;o<t.length;o++)for(r=0;r<e.getNumberOfRows();r++)if(e.getValue(r,0)==t[o]){if(0!=r){for(e.insertRows(0,1),r+=1,e.setRowProperties(0,e.getRowProperties(r)),n=0;n<e.getNumberOfColumns();n++)e.setValue(0,n,e.getValue(r,n));e.removeRow(r)}break}return e}(e,i),n=2;n<e.getNumberOfColumns();n+=2)e.setColumnProperties(n,{type:"string",role:"annotation"});for(n=3;n<=e.getNumberOfColumns();n+=4)e.insertColumn(n,{type:"string",role:"tooltip",p:{html:!0}}),e.insertColumn(n+1,{type:"string",role:"style"});var d=["Light Speed","Infusion of Light","Secure in the Light","Shocklight"],u=["Master of Shadows","Murderous Intent","Shadowbind","Torment the Weak","Chaotic Darkness","Dark Sorrows"];for(r=0;r<e.getNumberOfRows();r++){var g="",m=e.getValue(r,0);m==i[1]?g="stroke-width: 1; stroke-color: #808080; color: #b3b3b3":m==i[0]?g="stroke-width: 0.5; stroke-color: #4d4d4d; color: #808080":$.inArray(m,d)>=0?g="stroke-width: 3; stroke-color: #bb8800; color: #ffcc00":$.inArray(m,u)>=0&&(g="stroke-width: 3; stroke-color: #5500aa; color: #8800ff");var f=0,b=0;for(n=1;n<e.getNumberOfColumns();n+=4){var h=e.getValue(r,n),p=h-b,v=100*((o+h)/o-1);console.log(v);var w=v-f,y='<div class="chart-tooltip"><b>'+e.getValue(r,n+1)+"x "+m+"</b><br><b>Total:</b> "+a(v.toFixed(2))+"% ("+a(h.toFixed())+")<br><b>Increase:</b> "+a(w.toFixed(2))+"% ("+a(p.toFixed())+")</div>";e.setValue(r,n+2,y),e.setValue(r,n+3,g),e.setValue(r,n,w),w<0&&(e.setValue(r,n,0),e.setValue(r,n+1,"")),f=v>f?v:f,b=h>b?h:b}}var x=e.addColumn("number");for(r=0;r<e.getNumberOfRows();r++)$.inArray(e.getValue(r,0),d)>=0||$.inArray(e.getValue(r,0),u)>=0?e.setValue(r,x,1):e.setValue(r,x,0);e.sort([{column:x,desc:!1}]),e.removeColumn(x);var C=document.getElementById("simulations-metas"),S=C.innerWidth-2*window.getComputedStyle(C,null).getPropertyValue("padding-left"),k=document.documentElement.clientWidth>=768?S:700,I="#222222",V="#cccccc",E={title:t,backgroundColor:I,chartArea:{top:50,bottom:100,left:150,right:50},hAxis:{gridlines:{count:20},format:"#.#'%'",textStyle:{color:V},title:"% DPS Gain",titleTextStyle:{color:V},viewWindowMode:"maximized",viewWindow:{min:0}},vAxis:{textStyle:{fontSize:12,color:V},titleTextStyle:{color:V}},annotations:{highContrast:!1,stem:{color:"transparent",length:-12},textStyle:{fontName:'"Helvetica Neue", Helvetica, Arial, sans-serif',fontSize:10,bold:!0,color:I,auraColor:"transparent"}},titleTextStyle:{color:V},tooltip:{isHtml:!0},legend:{position:"none"},isStacked:!0,width:k};new google.visualization.BarChart(document.getElementById("google-chart")).draw(s(e),E),l(),c(E.chartArea)})})},e.trinketsInit=function(e,t,o){google.charts.load("current",{packages:["corechart"]}),google.charts.setOnLoadCallback(function(){$.get("/"+e,function(e){var n,r,i=(e=new google.visualization.arrayToDataTable(e)).addColumn("number");for(r=0;r<e.getNumberOfRows();r++){var d=0;for(n=1;n<i;n++)e.getValue(r,n)>d&&(d=e.getValue(r,n));e.setValue(r,i,d)}for(e.sort([{column:i,desc:!0}]),e.removeColumn(i),n=2;n<=e.getNumberOfColumns();n+=2)e.insertColumn(n,{type:"string",role:"tooltip",p:{html:!0}});for(r=0;r<e.getNumberOfRows();r++){var u=0,g=0;for(n=1;n<e.getNumberOfColumns();n+=2){var m=e.getValue(r,n),f=m-g,b=100*((o+m)/o-1),h=b-u,p='<div class="chart-tooltip"><b>'+e.getValue(r,0)+"<br> Item Level "+e.getColumnLabel(n)+"</b><br><b>Total:</b> "+a(b.toFixed(2))+"% ("+a(m.toFixed())+")<br><b>Increase:</b> "+a(h.toFixed(2))+"% ("+a(f.toFixed())+")</div>";e.setValue(r,n+1,p),e.setValue(r,n,h),u=b>u?b:u,g=m>g?m:g}}var v=document.getElementById("simulations-metas"),w=v.innerWidth-2*window.getComputedStyle(v,null).getPropertyValue("padding-left"),y=document.documentElement.clientWidth>=768?w:700,x="#cccccc",C={title:t,backgroundColor:"#222222",chartArea:{top:50,bottom:100,right:150,left:200},hAxis:{gridlines:{count:20},format:"#.#'%'",textStyle:{color:x},title:"% DPS Gain",titleTextStyle:{color:x},viewWindowMode:"maximized",viewWindow:{min:0}},vAxis:{textStyle:{fontSize:12,color:x},titleTextStyle:{color:x}},legend:{textStyle:{color:x}},titleTextStyle:{color:x},tooltip:{isHtml:!0},isStacked:!0,width:y};new google.visualization.BarChart(document.getElementById("google-chart")).draw(s(e),C),l(),c(C.chartArea)})})},e.hasInitialized=!0,window.herodamage=e);function a(e){return new Intl.NumberFormat("en-US").format(e)}function l(){var e=document.getElementById("herodamage-loading");e.parentNode.removeChild(e)}function s(e){var t=new google.visualization.DataView(e),o=t.getFilteredRows([{column:1,value:null}]);return t.hideRows(o),t.toDataTable()}function c(e){var t=document.getElementById("google-chart"),o=document.getElementById("chart-overlay");t.onmousemove=function(n){var r=t.getBoundingClientRect(),i=r.left+e.left+window.scrollX,a=r.right-e.right+window.scrollX,l=r.top+e.top+window.scrollY,s=r.bottom-e.bottom+window.scrollY;n.pageX>=i&&n.pageX<=a&&n.pageY>=l&&n.pageY<=s?(o.style.display="block",o.style.top=l+"px",o.style.left=n.pageX+"px",o.style.height=t.offsetHeight-e.top-e.bottom+"px"):o.style.display="none"}}}(window.herodamage||{});